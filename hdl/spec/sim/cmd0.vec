-- ***********************************************************************************
-- *** Warning: this file is automatically generated.                              ***
-- ***********************************************************************************
-- *** Do not edit this file directly as it is not the source!                     ***
-- ***********************************************************************************
-------------------------------------------------------------------------------
-- Generated from: simple.c - do not edit the vec file directly as it is not the source!
-- Short example of using the lambo TestBench
-------------------------------------------------------------------------------
-- Select the GN4124 Primary BFM
model %d0
-- Initialize the BFM to its default state
init

-- Drive reset to the FPGA
reset %d16

-------------------------------------------------------------------------------
-- Initialize the Primary GN412x BFM model
-------------------------------------------------------------------------------
-- These address ranges will generate traffic from the BFM to the FPGA
-- bar BAR ADDR SIZE VC TC S
bar     0 FF00000000000000 08000000 0 7 0
--bar     1 FF000000A0000000 10000000 1 5 0

-- This allocates a RAM block inside the BFM for the FPGA to access
-- bfm_bar BAR ADDR SIZE
bfm_bar 0 0000000040000000 20000000
bfm_bar 1 0000000020000000 20000000
-- bfm_bar 0 BB00000040000000 20000000
-- bfm_bar 1 00000000123456f8 20000000

-- Wait until the FPGA is un-reset and ready for traffic on the local bus
wait   %d64

-------------------------------------------------------------------------------
-- Access the descriptor memory in the Lambo design
-------------------------------------------------------------------------------
-- the following three writes will go out in a single packet

wr 0000000040000000 F C0FFEE82
wr 0000000040000004 F 00000001
wr 0000000040000008 F 00000002
wr 000000004000000C F 00000003
wr 0000000040000010 F 00000004
wr 0000000040000014 F 00000005
wr 0000000040000018 F 00000006
wr 000000004000001C F 00000007
wr 0000000040000020 F 00000008
wr 0000000040000024 F 00000009
wr 0000000040000028 F 0000000A
wr 000000004000002C F 0000000B
wr 0000000040000030 F 0000000C
wr 0000000040000034 F 0000000D
wr 0000000040000038 F 0000000E
wr 000000004000003C F 0000000F
wr 0000000040000040 F 00000010
wr 0000000040000044 F 00000011
wr 0000000040000048 F 00000012
wr 000000004000004C F 00000013
wr 0000000040000050 F 00000014
wr 0000000040000054 F 00000015
wr 0000000040000058 F 00000016
wr 000000004000005C F 00000017
wr 0000000040000060 F 00000018
wr 0000000040000064 F 00000019
wr 0000000040000068 F 0000001A
wr 000000004000006C F 0000001B
wr 0000000040000070 F 0000001C
wr 0000000040000074 F 0000001D
wr 0000000040000078 F 0000001E
wr 000000004000007C F 0000001F
wr 0000000040000080 F 00000020
wr 0000000040000084 F 00000021
wr 0000000040000088 F 00000022
wr 000000004000008C F 00000023
wr 0000000040000090 F 00000024
wr 0000000040000094 F 00000025
wr 0000000040000098 F 00000026
wr 000000004000009C F 00000027
wr 00000000400000A0 F 00000028
wr 00000000400000A4 F 00000029
wr 00000000400000A8 F 0000002A
wr 00000000400000AC F 0000002B
wr 00000000400000B0 F 0000002C
wr 00000000400000B4 F 0000002D
wr 00000000400000B8 F 0000002E
wr 00000000400000BC F 0000002F
wr 00000000400000C0 F 00000030

wr 0000000040000F00 F 00000F00
wr 0000000040000F04 F 00000F01
wr 0000000040000F08 F 00000F02
wr 0000000040000F0C F 00000F03
wr 0000000040000F10 F 00000F04
wr 0000000040000F14 F 00000F05
wr 0000000040000F18 F 00000F06
wr 0000000040000F1C F 00000F07
wr 0000000040000F20 F 00000F08
wr 0000000040000F24 F 00000F09
wr 0000000040000F28 F 00000F0A
wr 0000000040000F2C F 00000F0B
wr 0000000040000F30 F 00000F0C
wr 0000000040000F34 F 00000F0D
wr 0000000040000F38 F 00000F0E
wr 0000000040000F3C F 00000F0F
wr 0000000040000F40 F 00000F10
wr 0000000040000F44 F 00000F11
wr 0000000040000F48 F 00000F12
wr 0000000040000F4C F 00000F13
wr 0000000040000F50 F 00000F14
wr 0000000040000F54 F 00000F15
wr 0000000040000F58 F 00000F16
wr 0000000040000F5C F 00000F17
wr 0000000040000F60 F 00000F18
wr 0000000040000F64 F 00000F19
wr 0000000040000F68 F 00000F1A
wr 0000000040000F6C F 00000F1B
wr 0000000040000F70 F 00000F1C
wr 0000000040000F74 F 00000F1D
wr 0000000040000F78 F 00000F1E
wr 0000000040000F7C F 00000F1F
wr 0000000040000F80 F 00000F20
wr 0000000040000F84 F 00000F21
wr 0000000040000F88 F 00000F22
wr 0000000040000F8C F 00000F23
wr 0000000040000F90 F 00000F24
wr 0000000040000F94 F 00000F25
wr 0000000040000F98 F 00000F26
wr 0000000040000F9C F 00000F27
wr 0000000040000FA0 F 00000F28
wr 0000000040000FA4 F 00000F29
wr 0000000040000FA8 F 00000F2A
wr 0000000040000FAC F 00000F2B
wr 0000000040000FB0 F 00000F2C
wr 0000000040000FB4 F 00000F2D
wr 0000000040000FB8 F 00000F2E
wr 0000000040000FBC F 00000F2F

-- DMA item stored in host memory
------------------------------
-- Carrier start address
wr  0000000020000000 F 00001000
-- Host start address (lsb)
wr  0000000020000004 F 40001000
-- Host start address (msb)
wr  0000000020000008 F 00000000
-- DMA length
wr  000000002000000C F 00001000
-- Next item address (lsb)
wr  0000000020000010 F 20000020
-- Next item address (msb)
wr  0000000020000014 F 00000000
-- DMA attributes (from carrier to host, last item)
wr  0000000020000018 F 00000001

-- DMA item stored in host memory
------------------------------
-- Carrier start address
wr  0000000020000020 F 00002000
-- Host start address (lsb)
wr  0000000020000024 F 40002000
-- Host start address (msb)
wr  0000000020000028 F 00000000
-- DMA length
wr  000000002000002C F 00001000
-- Next item address (lsb)
wr  0000000020000030 F 20000040
-- Next item address (msb)
wr  0000000020000034 F 00000000
-- DMA attributes (from carrier to host, last item)
wr  0000000020000038 F 00000001

-- DMA item stored in host memory
------------------------------
-- Carrier start address
wr  0000000020000040 F 00003000
-- Host start address (lsb)
wr  0000000020000044 F 40003000
-- Host start address (msb)
wr  0000000020000048 F 00000000
-- DMA length
wr  000000002000004C F 00001000
-- Next item address (lsb)
wr  0000000020000050 F 20000060
-- Next item address (msb)
wr  0000000020000054 F 00000000
-- DMA attributes (from carrier to host, last item)
wr  0000000020000058 F 00000001

-- DMA item stored in host memory
------------------------------
-- Carrier start address
wr  0000000020000060 F 00004000
-- Host start address (lsb)
wr  0000000020000064 F 40004000
-- Host start address (msb)
wr  0000000020000068 F 00000000
-- DMA length
wr  000000002000006C F 00001000
-- Next item address (lsb)
wr  0000000020000070 F 20000080
-- Next item address (msb)
wr  0000000020000074 F 00000000
-- DMA attributes (from carrier to host, last item)
wr  0000000020000078 F 00000000

wait %d2000


-- onewire config
wr FF00000000001104 F 007C0270
wait %d100
wr FF00000000001100 F 0000000A
wait %d100

-- fmc eic set irq enable mask
wr FF00000000002004 F 00000003

-- dma eic set irq enable mask
wr FF00000000001404 F 00000003

-- vic set irq enable mask
wr FF00000000001308 F 00000003

-- vic config
wr FF00000000001300 F 00001777

-- release fmc reset
wr FF0000000000120C F 00000003

-- Set time-tag core seconds
wr FF00000000002100 F 00001234

-- Set time-tag core coarse time
wr FF00000000002104 F 00000000


-- trigger config (sw trig enable)
wr FF00000000005308 F 00000008
-- trigger config (hw int trig enable)
--wr FF00000000005308 F 00000004
-- trigger config (int trig)
--wr FF00000000005308 F 02600004

-- decimation factor = 1
wr FF0000000000531C F 00000001

-- pre-trig samples
wr FF00000000005320 F 00000000

-- post-trig samples
wr FF00000000005324 F 00000001

-- number of shots
wr FF00000000005314 F 00000003

-- Channel 1 gain
wr FF00000000005334 F 00008000
-- Channel 1 offset
wr FF00000000005338 F 00000000

-- Channel 2 gain
wr FF00000000005344 F 00008000
-- Channel 2 offset
wr FF00000000005348 F 00000000

-- Channel 3 gain
wr FF00000000005354 F 00008000
-- Channel 3 offset
wr FF00000000005358 F 00000000

-- Channel 4 gain
wr FF00000000005364 F 00008000
-- Channel 4 offset
wr FF00000000005368 F 00000000

-- Enable test data and sampling clock
--wr FF00000000005300 F 00000024
-- Enable sampling clock
wr FF00000000005300 F 00000004

wait   %d2000

-- start acquisition
--wr FF00000000005300 F 00000025
wr FF00000000005300 F 00000005

wait   %d800
-- sw trigger
wr FF00000000005310 F FFFFFFFF

wait   %d800
-- stop acquisition
--wr FF00000000005300 F 00000006

wait   %d800
-- sw trigger
wr FF00000000005310 F FFFFFFFF

wait   %d800
-- sw trigger
wr FF00000000005310 F FFFFFFFF

wait   %d800
-- sw trigger
--wr FF00000000005310 F FFFFFFFF

wait   %d800
-- sw trigger
--wr FF00000000005310 F FFFFFFFF

wait %d1000

-- DMA
------------------------------
-- Carrier start address
wr FF00000000001008 F 00000000
-- Host start address (lsb)
wr FF0000000000100C F 40000000
-- Host start address (msb)
wr FF00000000001010 F 00000000
-- DMA length
wr FF00000000001014 F 00001000
-- Next item address (lsb)
wr FF00000000001018 F 20000000
-- Next item address (msb)
wr FF0000000000101C F 00000000
-- DMA attributes (from carrier to host, last item)
wr FF00000000001020 F 00000001
-- Start DMA
wr FF00000000001000 F 00000001

wait %d3000
---------------------------------------------
---------------------------------------------

-- start acquisition
--wr FF00000000005300 F 00000001

wait   %d500
-- sw trigger
--wr FF00000000005310 F FFFFFFFF

wait %d400

-- DMA
------------------------------
-- Carrier start address
--wr FF00000000001008 F 00000000
-- Host start address (lsb)
--wr FF0000000000100C F 40000000
-- Host start address (msb)
--wr FF00000000001010 F 00000000
-- DMA length
--wr FF00000000001014 F 00000200
-- Next item address (lsb)
--wr FF00000000001018 F 20000000
-- Next item address (msb)
--wr FF0000000000101C F 00000000
-- DMA attributes (from carrier to host, last item)
--wr FF00000000001020 F 00000000
-- Start DMA
--wr FF00000000001000 F 00000001

wait %d1000








-- FMC I2C (prescaler)
--wr FF00000000080000 F 000000F9
--rd FF00000000080000 F 000000F9 FFFFFFFF
wait   %d640

-- Carrier CSR (read carrier type and PCB version)
--rd FF00000000030000 F 00010001 FFFFFFFF
-- Carrier CSR (switch front panel LED ON)
--wr FF00000000030010 F 00000003
--rd FF00000000030010 F 00000003 FFFFFFFF
wait   %d640

-- FMC SPI (divider = 100)
--wr FF00000000070014 F 00000064
-- FMC SPI (select ADC)
--wr FF00000000070018 F 00000001
-- FMC SPI (data)
--wr FF00000000070000 F 000081FF
-- FMC SPI (ass, tx_neg, go, len=16)
--wr FF00000000070010 F 00002510


wait   %d300


-- Now read back what was just written
-- the following three reads will go out as a single request
--rdb FF00000010004004 F FEEDFACE FFFFFFFF
--rdb FF00000010004008 F DBDBDBDB FFFFFFFF


--rd FF00000010004008 F DEADBEEF FFFFFFFF

--wrb FF0000001000401C F 00000000
--wrb FF00000010004024 F 00000000
--wr  FF00000010004000 F 00000001

--rdb FF00000010004000 F 00000002 FFFFFFFF
--rdb FF00000010004004 F 00000000 FFFFFFFF
--rdb FF00000010004008 F 5A5A5A5A FFFFFFFF
--rdb FF0000001000400C F 12345678 FFFFFFFF
--rdb FF00000010004010 F 00000000 FFFFFFFF
--rdb FF00000010004014 F 00000010 FFFFFFFF
--rdb FF00000010004018 F 00000000 FFFFFFFF
--rdb FF0000001000401C F 00000000 FFFFFFFF
--rd  FF00000010004020 F 00000000 FFFFFFFF
wait   %d160
--wr  FF00000010004000 F 00000001

--rd FF0000001000400C F DEADBEEF FFFFFFFF
--rd FF00000010004008 F ABABABAB FFFFFFFF

wait %d

flush  %d256

wait   %d16

sync
